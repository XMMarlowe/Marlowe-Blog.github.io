---
title: 死锁产生的原因以及产生的必要条件
author: Marlowe
abbrlink: 19334
date: 2021-04-09 13:41:29
tags: 死锁
categories: 操作系统
---

<!--more-->

### 死锁产生的原因

1. 系统资源不足。
2. 进程运行推进的顺序不合适。
3. 资源分配不当。

### 死锁产生的四个必要条件

1. 互斥条件：一个资源每次只能被一个进程使用。
2. 请求与保持条件：一个进程因请求资源而阻塞时，对已经获得的资源保持不放。
3. 不剥夺条件：进程已获得的资源，在未使用完之前，不能强行剥夺。
4. 循环等待条件：若干进程之间形成一种头尾相接的循环等待资源关系。


### 如何避免死锁？

**1. 避免嵌套锁**
如果您已经持有一个资源，请避免锁定另一个资源。如果只使用一个对象锁，则几乎不可能出现死锁情况。


**2. 只锁需要的部分**
只获对需要的资源加锁，例如在程序中，我们锁定了完整的对象资源，但是如果我们只需要其中一个字段，那么我们应该只锁定那个特定的字段而不是完整的对象。

**3. 避免无限期等待**
如果两个线程使用 thread join 无限期互相等待也会造成死锁，我们可以设定等待的最大时间来避免这种情况。